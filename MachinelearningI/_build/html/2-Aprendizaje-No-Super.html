
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2.Aprendizaje no supervisado &#8212; Práctica Machine Learning I</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3. Técnicas de reduccion de la dimensionalidad" href="3-Reduccion_dimensionalidad.html" />
    <link rel="prev" title="1. ANALISIS INICIAL" href="1-DefinicionObjetivos.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/HH-Logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Práctica Machine Learning I</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="1-DefinicionObjetivos.html">
   1. ANALISIS INICIAL
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   2.Aprendizaje no supervisado
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3-Reduccion_dimensionalidad.html">
   3. Técnicas de reduccion de la dimensionalidad
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4-Aprendizaje_supervisado.html">
   3. Aprendizaje Supervisado
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/2-Aprendizaje-No-Super.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F2-Aprendizaje-No-Super.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/2-Aprendizaje-No-Super.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visualizacion-de-los-datos">
   Visualización de los datos
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#k-means">
   K-Means
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dbscan">
   DBSCAN
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hierarchical-clustering">
   Hierarchical clustering
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="aprendizaje-no-supervisado">
<h1>2.Aprendizaje no supervisado<a class="headerlink" href="#aprendizaje-no-supervisado" title="Permalink to this headline">¶</a></h1>
<p>Cargamos las librerías que vamos a necesitar  y el archivo donde se encuetran las funiones que usaremos posteriormente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">src.utils</span> <span class="kn">import</span> <span class="n">pd</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">plt</span>

<span class="c1"># Useful functions</span>
<span class="kn">from</span> <span class="nn">src.utils</span> <span class="kn">import</span> <span class="n">load_examples</span><span class="p">,</span> <span class="n">plot_scatter</span><span class="p">,</span> <span class="n">plot_silhouette</span>
</pre></div>
</div>
</div>
</div>
<p>Cargamos los datos con las variables ya que hemos previamente selecionado.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># cargamos los datos</span>
<span class="n">data_RF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;seleccion_variables_RF_bathandrooms.csv&quot;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

<span class="n">data_RF</span> <span class="o">=</span> <span class="n">data_RF</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="c1">#eliminamos la primera columna. </span>

<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Rooms&#39;</span><span class="p">,</span><span class="s1">&#39;Distance&#39;</span><span class="p">,</span><span class="s1">&#39;Postcode&#39;</span><span class="p">,</span><span class="s1">&#39;Bathroom&#39;</span><span class="p">,</span><span class="s1">&#39;Car&#39;</span><span class="p">,</span><span class="s1">&#39;Landsize&#39;</span><span class="p">,</span><span class="s1">&#39;Propertycount&#39;</span><span class="p">,</span><span class="s1">&#39;Distancia_NEW&#39;</span><span class="p">,</span><span class="s1">&#39;Longtitude&#39;</span><span class="p">,</span><span class="s1">&#39;Lattitude&#39;</span><span class="p">,</span><span class="s1">&#39;Location_TRA&#39;</span><span class="p">,</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span>
<span class="n">data_RF</span><span class="o">=</span><span class="n">data_RF</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span>
<span class="c1">#ponemos la columna precio al final</span>

<span class="n">data_RF</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">data_RF</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Rooms</th>
      <th>Distance</th>
      <th>Postcode</th>
      <th>Bathroom</th>
      <th>Car</th>
      <th>Landsize</th>
      <th>Propertycount</th>
      <th>Distancia_NEW</th>
      <th>Longtitude</th>
      <th>Lattitude</th>
      <th>Location_TRA</th>
      <th>Price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>27056.000000</td>
      <td>27056.000000</td>
      <td>27056.000000</td>
      <td>27056.000000</td>
      <td>27056.000000</td>
      <td>27056.000000</td>
      <td>27056.000000</td>
      <td>27056.000000</td>
      <td>27056.000000</td>
      <td>27056.000000</td>
      <td>27056.000000</td>
      <td>2.705600e+04</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.994530</td>
      <td>11.314033</td>
      <td>3114.204590</td>
      <td>1.552262</td>
      <td>1.667431</td>
      <td>612.205509</td>
      <td>7573.720166</td>
      <td>11.952305</td>
      <td>145.008020</td>
      <td>-37.808097</td>
      <td>3.835397</td>
      <td>1.053621e+06</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.950429</td>
      <td>6.799548</td>
      <td>111.501632</td>
      <td>0.675360</td>
      <td>0.918234</td>
      <td>3249.934429</td>
      <td>4496.112130</td>
      <td>7.849907</td>
      <td>0.111148</td>
      <td>0.083232</td>
      <td>0.007949</td>
      <td>6.432746e+05</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>3000.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>83.000000</td>
      <td>0.174520</td>
      <td>144.540220</td>
      <td>-38.190430</td>
      <td>3.800381</td>
      <td>8.500000e+04</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.000000</td>
      <td>6.400000</td>
      <td>3046.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>264.000000</td>
      <td>4294.000000</td>
      <td>6.007600</td>
      <td>144.950700</td>
      <td>-37.852207</td>
      <td>3.831049</td>
      <td>6.400000e+05</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3.000000</td>
      <td>10.500000</td>
      <td>3088.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>509.000000</td>
      <td>6567.000000</td>
      <td>10.276541</td>
      <td>145.016100</td>
      <td>-37.807955</td>
      <td>3.835749</td>
      <td>8.750000e+05</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4.000000</td>
      <td>14.000000</td>
      <td>3155.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>661.000000</td>
      <td>10412.000000</td>
      <td>15.780575</td>
      <td>145.068500</td>
      <td>-37.760771</td>
      <td>3.839746</td>
      <td>1.300000e+06</td>
    </tr>
    <tr>
      <th>max</th>
      <td>16.000000</td>
      <td>48.100000</td>
      <td>3978.000000</td>
      <td>9.000000</td>
      <td>18.000000</td>
      <td>433014.000000</td>
      <td>21650.000000</td>
      <td>49.578383</td>
      <td>145.526350</td>
      <td>-37.397800</td>
      <td>3.877280</td>
      <td>1.120000e+07</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>No contamos con variables cualitativas.</p>
<p>Añadimos una columna adicional categorica para clasificar el precio como hemos visto en el analisis anterior donde dividimos las casa en cara y baratas en funcion de la mediana.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>-Casas caras como 1
-Casas baratas como 0 
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>

<span class="c1"># Categorizamos el precio</span>
<span class="n">mediana</span><span class="o">=</span> <span class="mf">870000.0</span>
<span class="n">data_RF</span><span class="p">[</span><span class="s2">&quot;precio_div&quot;</span><span class="p">]</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data_RF</span><span class="p">[</span><span class="s2">&quot;Price&quot;</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">mediana</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span> <span class="p">)</span><span class="c1">#1 es caro Y 0 es barato </span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_RF</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>

<span class="c1">#Eliminamos del dataframe las varibales categoricas  ya que no son  relevantes</span>
<span class="n">data_RF</span><span class="o">=</span><span class="n">data_RF</span><span class="p">[[</span><span class="s1">&#39;Rooms&#39;</span><span class="p">,</span><span class="s1">&#39;Distance&#39;</span><span class="p">,</span><span class="s1">&#39;Bathroom&#39;</span><span class="p">,</span><span class="s1">&#39;Car&#39;</span><span class="p">,</span><span class="s1">&#39;Landsize&#39;</span><span class="p">,</span><span class="s1">&#39;Distancia_NEW&#39;</span><span class="p">,</span><span class="s1">&#39;Longtitude&#39;</span><span class="p">,</span><span class="s1">&#39;Lattitude&#39;</span><span class="p">,</span><span class="s1">&#39;Price&#39;</span><span class="p">,</span><span class="s1">&#39;precio_div&#39;</span><span class="p">]]</span>

<span class="c1"># convertimos el DataFrame al formato necesario para scikit-learn</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_RF</span><span class="p">[[</span><span class="s1">&#39;Rooms&#39;</span><span class="p">,</span><span class="s1">&#39;Distance&#39;</span><span class="p">,</span><span class="s1">&#39;Bathroom&#39;</span><span class="p">,</span><span class="s1">&#39;Car&#39;</span><span class="p">,</span><span class="s1">&#39;Landsize&#39;</span><span class="p">,</span><span class="s1">&#39;Distancia_NEW&#39;</span><span class="p">,</span><span class="s1">&#39;Longtitude&#39;</span><span class="p">,</span><span class="s1">&#39;Lattitude&#39;</span><span class="p">,</span><span class="s1">&#39;Price&#39;</span><span class="p">,</span><span class="s1">&#39;precio_div&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">data</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="c1"># aqui no se que hace quitamos la cateogiria creo</span>



<span class="n">y_price_cat</span><span class="o">=</span><span class="n">data</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="c1">#seleccionamos solo la variable precio_div</span>
<span class="n">y_price</span><span class="o">=</span><span class="n">data</span><span class="p">[:,</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> 
<span class="n">X_selec</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># seleccionamos las variables &#39;Distancia_NEW&#39;,&#39;Longtitude&#39;,&#39;Lattitude&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_price_cat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Rooms  Distance  Postcode  Bathroom  Car  Landsize  Propertycount  \
0       2       2.5    3067.0         1    1     202.0         4019.0   
1       2       2.5    3067.0         1    0     156.0         4019.0   
2       3       2.5    3067.0         2    0     134.0         4019.0   
3       3       2.5    3067.0         2    0     134.0         4019.0   
4       3       2.5    3067.0         2    0     134.0         4019.0   
5       3       2.5    3067.0         2    0     134.0         4019.0   
6       3       2.5    3067.0         2    0     134.0         4019.0   
7       3       2.5    3067.0         2    0     134.0         4019.0   
8       3       2.5    3067.0         2    1      94.0         4019.0   
9       4       2.5    3067.0         1    2     120.0         4019.0   
10      2       2.5    3067.0         1    0     181.0         4019.0   
11      3       2.5    3067.0         2    0     245.0         4019.0   
12      2       2.5    3067.0         1    2     256.0         4019.0   
13      3       2.5    3067.0         2    1    1239.0         4019.0   
14      2       2.5    3067.0         2    1     629.1         4019.0   
15      1       2.5    3067.0         1    1       0.0         4019.0   
16      2       2.5    3067.0         1    2     220.0         4019.0   
17      2       2.5    3067.0         1    1     443.9         4019.0   
18      2       2.5    3067.0         1    1     783.9         4019.0   
19      1       2.5    3067.0         1    1       0.0         4019.0   

    Distancia_NEW  Longtitude  Lattitude  Location_TRA    Price precio_div  
0        5.744380  144.998400 -37.799600      3.835977  1480000          1  
1        5.298425  144.993400 -37.807900      3.835003  1035000          1  
2        5.125216  144.994400 -37.809300      3.834887  1465000          1  
3        9.827458  144.963400 -37.774500      3.837599  1465000          1  
4        5.085926  145.091600 -37.850900      3.833240  1465000          1  
5       19.298740  144.832900 -37.774900      3.834104  1465000          1  
6        7.022620  145.111600 -37.825500      3.836343  1465000          1  
7        8.495644  145.055900 -37.917250      3.825591  1465000          1  
8        6.067094  144.996900 -37.796900      3.836211   850000          0  
9        5.313383  144.994100 -37.807200      3.835092  1600000          1  
10       5.505113  144.995300 -37.804100      3.835438   941000          1  
11       5.443243  144.999300 -37.802400      3.835717  1876000          1  
12       5.337487  144.995400 -37.806000      3.835248  1636000          1  
13       5.136303  144.995928 -37.808343      3.835045  1000000          1  
14       4.993832  144.997110 -37.808225      3.835049   745000          0  
15       5.689908  144.997300 -37.800800      3.835826   300000          0  
16       5.591050  144.998900 -37.801000      3.835848  1097000          1  
17       4.715016  145.000598 -37.809055      3.835057   542000          0  
18       5.047683  144.997080 -37.808165      3.835073   760000          0  
19       5.116999  144.996500 -37.808392      3.835045   481000          0  
[&#39;1&#39; &#39;1&#39; &#39;1&#39; ... &#39;0&#39; &#39;1&#39; &#39;1&#39;]
</pre></div>
</div>
</div>
</div>
<p>Estandarizamos lo datos para poder agruparlos y representarlos mejor.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mas reduccion de la dimensionalidad </span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="n">data_RF</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span><span class="c1"># quitamos las columnas de precio categorizado </span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">Xs</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="visualizacion-de-los-datos">
<h2>Visualización de los datos<a class="headerlink" href="#visualizacion-de-los-datos" title="Permalink to this headline">¶</a></h2>
<p>Primero reducimos la dimensionalidad  con el TSNE para poder representar todas la variables
Tambien probamos selecionado las variables  fueron selecionadas en los  modelos ateriores  “Distania_NEW”, ” Latitude” y “longitude”.</p>
<p>“Distania_NEW”, “Room” ” Latitude”, “Landsize” y ” Bathrooms”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.manifold</span> <span class="kn">import</span> <span class="n">TSNE</span>

<span class="c1">#Cogemos una muestra del dataframe y realizamos un TSNE </span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">random_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">Xs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">N</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">X_tsne</span> <span class="o">=</span> <span class="n">TSNE</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">perplexity</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">Xs</span><span class="p">[</span><span class="n">random_idx</span><span class="p">,:])</span><span class="c1"># tecnica de reduccin del todo el data frame se queda con 3 columans </span>


<span class="c1">#Seleccionamos las columnas que mas nos interesan que son las anteriormente indicadas. </span>
<span class="n">X_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_RF</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">X_new</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(27056, 3)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_RF</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="c1"># esto no se por que lo ha hecho. </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([5.29842457362017, 144.9934, -37.8079], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Visualizacion de los datos con TSNE. Habria que probar diferentes preplexies para ver cual es la que se adapta mejor.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Visualizacion de los datos por el TSNE&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_tsne</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_tsne</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>


<span class="c1">#----------------------------</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">Axes3D</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="n">colores</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;yellow&#39;</span><span class="p">]</span>
<span class="n">asignar</span><span class="o">=</span><span class="p">[]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_price_cat</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">y_pintar</span><span class="o">=</span><span class="n">y_price_cat</span><span class="p">[</span><span class="n">random_idx</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_pintar</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">y_pintar</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">):</span>
    <span class="n">asignar</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">colores</span><span class="p">[</span><span class="n">row</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_tsne</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_tsne</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">X_tsne</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">asignar</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="c1">#ax.scatter(X_new[:, 1], X_new[:, 2], X_new[:, 0], c=asignar,s=20)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Visualizacion de los datos por el TSNE
</pre></div>
</div>
<img alt="_images/2-Aprendizaje-No-Super_12_1.png" src="_images/2-Aprendizaje-No-Super_12_1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
[&#39;1&#39; &#39;0&#39; &#39;1&#39; ... &#39;0&#39; &#39;0&#39; &#39;0&#39;]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;mpl_toolkits.mplot3d.art3d.Path3DCollection at 0x7f972f090eb0&gt;
</pre></div>
</div>
<img alt="_images/2-Aprendizaje-No-Super_12_4.png" src="_images/2-Aprendizaje-No-Super_12_4.png" />
</div>
</div>
<p>Visualizamos con las categorias seleccionadas para ver si tiene sentido o es mas claro.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Visualizacion de los datos con las categorias seleccionadas&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_new</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_new</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>


<span class="c1">#----------------------------</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">Axes3D</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="n">colores</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;yellow&#39;</span><span class="p">]</span>
<span class="n">asignar</span><span class="o">=</span><span class="p">[]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_price_cat</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">y_pintar</span><span class="o">=</span><span class="n">y_price_cat</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_pintar</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">y_pintar</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">):</span>
    <span class="n">asignar</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">colores</span><span class="p">[</span><span class="n">row</span><span class="p">])</span>

<span class="c1">#ax.scatter(X_tsne[:, 0], X_tsne[:, 1], X_tsne[:, 2], c=asignar,s=40)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_new</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">X_new</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">X_new</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">asignar</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Visualizacion de los datos con las categorias seleccionadas
</pre></div>
</div>
<img alt="_images/2-Aprendizaje-No-Super_14_1.png" src="_images/2-Aprendizaje-No-Super_14_1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
[&#39;1&#39; &#39;1&#39; &#39;1&#39; ... &#39;0&#39; &#39;1&#39; &#39;1&#39;]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;mpl_toolkits.mplot3d.art3d.Path3DCollection at 0x7f972efe2df0&gt;
</pre></div>
</div>
<img alt="_images/2-Aprendizaje-No-Super_14_4.png" src="_images/2-Aprendizaje-No-Super_14_4.png" />
</div>
</div>
<p>Parece que se ven mejor seleccionando las categorias que hemos seleccionado.En el cual, los datos mas caros estan abajo  naranjas y se difunden con los azules amedida que aumentamos al distancia al centro.</p>
<p>Duda: las variables estan correlacionadas?? Poner ejemplos de otras varaibles??</p>
</div>
<div class="section" id="k-means">
<h2>K-Means<a class="headerlink" href="#k-means" title="Permalink to this headline">¶</a></h2>
<p>Usaremos este modelo por que es simple y util para dataset grandes además es una técnica escalable.</p>
<p>La estrategia que usaremos para realizar K-Means es :</p>
<ul class="simple">
<li><p>Representar <code class="docutils literal notranslate"><span class="pre">inertia</span></code>  para determinar el mejor número de clusters.</p></li>
<li><p>Analizar el numero de muestras en cada uno de los clusters y la sumas de las distancias al centroide.</p></li>
<li><p>Para cada cluster, <code class="docutils literal notranslate"><span class="pre">display</span></code>  el ejemplo de <span class="math notranslate nohighlight">\(n\)</span>  mas cercano y el mas lejano  de cada centroide.</p></li>
<li><p>Analyze the features distribution for each cluster.</p></li>
</ul>
<p>La idea es pasarle el que procede TNSE y las 3 mejores columnas. Comenzamos con  las 3 mejores variables según nuesta seleccion anterior ya que los resultados del TNSE no eran muy especificos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>

<span class="n">K</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>

<span class="n">inertia</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">K</span><span class="p">:</span>
    <span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_new</span><span class="p">)</span>
    <span class="n">inertia</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kmeans</span><span class="o">.</span><span class="n">inertia_</span><span class="p">)</span>
       
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Inertia acorde a las categorias selecionadas&quot;</span><span class="p">)</span>  

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">inertia</span><span class="p">,</span><span class="s1">&#39;.-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;# of clusters&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Inertia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Inertia acorde a las categorias selecionadas
</pre></div>
</div>
<img alt="_images/2-Aprendizaje-No-Super_17_1.png" src="_images/2-Aprendizaje-No-Super_17_1.png" />
</div>
</div>
<p>La “inertia” corresponde a mas o menos 3 o 4 clusters. Comprobaremos que es mejor posteriormente.
Realizamos el algoritmo de K Means, primero probamos con 4 cluster segun hemos visualizado.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">4</span> 
<span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">labels_km</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X_new</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cluster sizes k-means: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">labels_km</span><span class="p">)))</span>

<span class="n">distances</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">:</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">X_new</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> 
    <span class="n">distances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cluster distances k-means: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">labels_km</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="n">distances</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plot_silhouette</span><span class="p">(</span><span class="n">X_new</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span><span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cluster sizes k-means: [ 8884 11759  1540  4873]
Cluster distances k-means: [1672490.31, 2778670.18, 14105984.11, 3397020.5]
</pre></div>
</div>
<img alt="_images/2-Aprendizaje-No-Super_19_1.png" src="_images/2-Aprendizaje-No-Super_19_1.png" />
</div>
</div>
<p>Parece que los clusters estan bastante descompensados, se puede observar en los diferentes tamaños y distancias, a pesar de que el coeficiende de silueta esta cerca de 0,6 por lo que los puntos de diferentes centroides estan bastante separados.</p>
<p>Relizamos la misma prueba pero con 3 clusters para ver como se distribuyen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">3</span> 
<span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">labels_km</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X_new</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cluster sizes k-means: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">labels_km</span><span class="p">)))</span>

<span class="n">distances</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">:</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">X_new</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> 
    <span class="n">distances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cluster distances k-means: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">labels_km</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="n">distances</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plot_silhouette</span><span class="p">(</span><span class="n">X_new</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span><span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cluster sizes k-means: [10017 14750  2289]
Cluster distances k-means: [2069676.44, 2485170.9, 11070221.75]
</pre></div>
</div>
<img alt="_images/2-Aprendizaje-No-Super_21_1.png" src="_images/2-Aprendizaje-No-Super_21_1.png" />
<img alt="_images/2-Aprendizaje-No-Super_21_2.png" src="_images/2-Aprendizaje-No-Super_21_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clusters</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">labels_km</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Parece que los clusters estan bastante descompensados, se puede observar en los diferentes tamaños y distancias. Sin embargo, en el coeficiente de silueta vemos que todos soperan el 0.6 por lo que estan bastante separados unos cluster de otros aunque los tamaños no lo sean.</p>
<p>Podemos conlcuir que la separacion en 3 cluster es mas precisa ya que estan mejor separados entre si los datos de los diferentes clusters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##Yo casi que quitaria esto </span>

<span class="c1">#import pandas as pd</span>
<span class="c1">#import numpy as np</span>
<span class="c1">#import matplotlib.pyplot as plt</span>
<span class="c1">#import seaborn as sb</span>

<span class="c1">#from mpl_toolkits.mplot3d import Axes3D</span>
<span class="c1">#fig = plt.figure(figsize=(6, 6))</span>
<span class="c1">#ax = Axes3D(fig)</span>

<span class="c1">#colores=[&#39;cyan&#39;,&#39;orange&#39;,&#39;blue&#39;,&#39;yellow&#39;]</span>
<span class="c1">#asignarx=[]</span>

<span class="c1">#for row in labels_km.astype(&#39;int32&#39;):# asiga a cada row rn labels un color diferente  para cada uno de los clusters</span>
    <span class="c1">#asignarx.append(colores[row])</span>

<span class="c1">#ax.scatter(X_new[:, 1], X_new[:, 2], X_new[:, 0], c=asignarx,s=20)#AQUI parece que esta usadno el resutlado de Kmeans</span>
<span class="c1">#data_RF[&#39;cluster&#39;]=labels_km</span>



<span class="c1">#sb.pairplot(data_RF.dropna(), hue=&#39;cluster&#39;,size=4,vars=[&quot;Lattitude&quot;,&quot;Distancia_NEW&quot;,&quot;Longtitude&quot;,&quot;precio_div&quot;],kind=&#39;scatter&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">close_to_far_from_center</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">centroid</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    
    <span class="n">distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">X</span> <span class="o">-</span> <span class="n">centroid</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Close to center&#39;</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">data_RF</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">distance</span><span class="p">)[:</span><span class="n">n</span><span class="p">]])</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Far from center&#39;</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">data_RF</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">distance</span><span class="p">)[</span><span class="o">-</span><span class="n">n</span><span class="p">:]])</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cluster 0&quot;</span><span class="p">)</span>
<span class="n">close_to_far_from_center</span><span class="p">(</span><span class="n">X_new</span><span class="p">,</span><span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="c1">#stats.describe(kmeans.cluster_centers_[1].sort())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cluster 0
Close to center
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Rooms</th>
      <th>Distance</th>
      <th>Bathroom</th>
      <th>Car</th>
      <th>Landsize</th>
      <th>Distancia_NEW</th>
      <th>Longtitude</th>
      <th>Lattitude</th>
      <th>Price</th>
      <th>precio_div</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>21585</th>
      <td>3</td>
      <td>13.1</td>
      <td>1</td>
      <td>3</td>
      <td>639.0</td>
      <td>15.811153</td>
      <td>144.97480</td>
      <td>-37.70830</td>
      <td>910000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>18434</th>
      <td>3</td>
      <td>13.1</td>
      <td>1</td>
      <td>2</td>
      <td>681.0</td>
      <td>15.813687</td>
      <td>144.97966</td>
      <td>-37.70697</td>
      <td>706000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>24657</th>
      <td>3</td>
      <td>13.1</td>
      <td>2</td>
      <td>2</td>
      <td>689.0</td>
      <td>15.822574</td>
      <td>144.97687</td>
      <td>-37.70762</td>
      <td>750000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8750</th>
      <td>3</td>
      <td>12.4</td>
      <td>1</td>
      <td>4</td>
      <td>592.0</td>
      <td>15.785883</td>
      <td>144.96640</td>
      <td>-37.71110</td>
      <td>640000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>26156</th>
      <td>3</td>
      <td>12.0</td>
      <td>1</td>
      <td>2</td>
      <td>587.0</td>
      <td>15.819036</td>
      <td>144.99782</td>
      <td>-37.70309</td>
      <td>730000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6610</th>
      <td>3</td>
      <td>11.2</td>
      <td>1</td>
      <td>2</td>
      <td>945.0</td>
      <td>15.821383</td>
      <td>145.00010</td>
      <td>-37.70270</td>
      <td>779000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8775</th>
      <td>4</td>
      <td>12.4</td>
      <td>1</td>
      <td>2</td>
      <td>0.0</td>
      <td>15.777563</td>
      <td>144.96820</td>
      <td>-37.71060</td>
      <td>752500</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5924</th>
      <td>3</td>
      <td>9.9</td>
      <td>1</td>
      <td>2</td>
      <td>590.0</td>
      <td>15.782459</td>
      <td>144.95070</td>
      <td>-37.71700</td>
      <td>683500</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5979</th>
      <td>3</td>
      <td>9.9</td>
      <td>2</td>
      <td>1</td>
      <td>122.0</td>
      <td>15.797090</td>
      <td>144.93730</td>
      <td>-37.72310</td>
      <td>600000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6430</th>
      <td>2</td>
      <td>11.2</td>
      <td>1</td>
      <td>2</td>
      <td>950.0</td>
      <td>15.790696</td>
      <td>145.00710</td>
      <td>-37.70200</td>
      <td>810000</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Far from center
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Rooms</th>
      <th>Distance</th>
      <th>Bathroom</th>
      <th>Car</th>
      <th>Landsize</th>
      <th>Distancia_NEW</th>
      <th>Longtitude</th>
      <th>Lattitude</th>
      <th>Price</th>
      <th>precio_div</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20214</th>
      <td>3</td>
      <td>45.9</td>
      <td>2</td>
      <td>4</td>
      <td>40468.0</td>
      <td>48.231807</td>
      <td>144.63257</td>
      <td>-37.54812</td>
      <td>930000</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>17077</th>
      <td>4</td>
      <td>47.3</td>
      <td>2</td>
      <td>2</td>
      <td>488.6</td>
      <td>48.306749</td>
      <td>145.51137</td>
      <td>-38.05934</td>
      <td>442000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>23275</th>
      <td>3</td>
      <td>44.2</td>
      <td>1</td>
      <td>1</td>
      <td>555.5</td>
      <td>48.416964</td>
      <td>144.97782</td>
      <td>-37.40869</td>
      <td>390000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>16710</th>
      <td>3</td>
      <td>44.2</td>
      <td>1</td>
      <td>1</td>
      <td>502.0</td>
      <td>48.437659</td>
      <td>144.97749</td>
      <td>-37.40853</td>
      <td>366000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>11188</th>
      <td>3</td>
      <td>45.2</td>
      <td>2</td>
      <td>4</td>
      <td>724.0</td>
      <td>48.465570</td>
      <td>145.52635</td>
      <td>-37.64685</td>
      <td>650000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>25562</th>
      <td>4</td>
      <td>44.2</td>
      <td>2</td>
      <td>2</td>
      <td>757.0</td>
      <td>48.509563</td>
      <td>144.98302</td>
      <td>-37.40744</td>
      <td>560000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>20801</th>
      <td>3</td>
      <td>44.2</td>
      <td>1</td>
      <td>2</td>
      <td>679.0</td>
      <td>48.599281</td>
      <td>144.97590</td>
      <td>-37.40720</td>
      <td>411000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>27016</th>
      <td>4</td>
      <td>44.2</td>
      <td>2</td>
      <td>6</td>
      <td>720.0</td>
      <td>49.150316</td>
      <td>144.96232</td>
      <td>-37.40349</td>
      <td>565000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>23274</th>
      <td>5</td>
      <td>44.2</td>
      <td>3</td>
      <td>2</td>
      <td>908.8</td>
      <td>49.449786</td>
      <td>145.00176</td>
      <td>-37.39780</td>
      <td>600000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>23276</th>
      <td>4</td>
      <td>44.2</td>
      <td>2</td>
      <td>2</td>
      <td>924.0</td>
      <td>49.578383</td>
      <td>144.96369</td>
      <td>-37.39946</td>
      <td>590000</td>
      <td>0</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cluster 1&quot;</span><span class="p">)</span>
<span class="n">close_to_far_from_center</span><span class="p">(</span><span class="n">X_new</span><span class="p">,</span><span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cluster 1
Close to center
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Rooms</th>
      <th>Distance</th>
      <th>Bathroom</th>
      <th>Car</th>
      <th>Landsize</th>
      <th>Distancia_NEW</th>
      <th>Longtitude</th>
      <th>Lattitude</th>
      <th>Price</th>
      <th>precio_div</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>18042</th>
      <td>4</td>
      <td>5.9</td>
      <td>2</td>
      <td>3</td>
      <td>620.0</td>
      <td>0.174520</td>
      <td>145.033760</td>
      <td>-37.843910</td>
      <td>3080000</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4743</th>
      <td>3</td>
      <td>6.2</td>
      <td>1</td>
      <td>2</td>
      <td>363.1</td>
      <td>0.203503</td>
      <td>145.033978</td>
      <td>-37.842145</td>
      <td>1706000</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4742</th>
      <td>2</td>
      <td>6.2</td>
      <td>2</td>
      <td>2</td>
      <td>0.0</td>
      <td>0.210908</td>
      <td>145.034300</td>
      <td>-37.840700</td>
      <td>1290000</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4741</th>
      <td>4</td>
      <td>6.2</td>
      <td>2</td>
      <td>3</td>
      <td>641.6</td>
      <td>0.200678</td>
      <td>145.035127</td>
      <td>-37.844022</td>
      <td>1815000</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>26725</th>
      <td>4</td>
      <td>5.9</td>
      <td>4</td>
      <td>3</td>
      <td>630.0</td>
      <td>0.201492</td>
      <td>145.036430</td>
      <td>-37.843820</td>
      <td>2900000</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>26010</th>
      <td>2</td>
      <td>5.9</td>
      <td>1</td>
      <td>1</td>
      <td>194.1</td>
      <td>0.216733</td>
      <td>145.035148</td>
      <td>-37.843318</td>
      <td>1310000</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>17021</th>
      <td>2</td>
      <td>5.9</td>
      <td>1</td>
      <td>2</td>
      <td>275.4</td>
      <td>0.216733</td>
      <td>145.036874</td>
      <td>-37.843399</td>
      <td>820000</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8168</th>
      <td>2</td>
      <td>4.6</td>
      <td>1</td>
      <td>1</td>
      <td>0.0</td>
      <td>0.324376</td>
      <td>145.031300</td>
      <td>-37.841600</td>
      <td>690000</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8120</th>
      <td>3</td>
      <td>4.6</td>
      <td>1</td>
      <td>0</td>
      <td>1099.0</td>
      <td>0.417594</td>
      <td>145.030300</td>
      <td>-37.843800</td>
      <td>1635000</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>25014</th>
      <td>2</td>
      <td>4.1</td>
      <td>1</td>
      <td>1</td>
      <td>251.4</td>
      <td>0.486102</td>
      <td>145.028589</td>
      <td>-37.840413</td>
      <td>700000</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Far from center
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Rooms</th>
      <th>Distance</th>
      <th>Bathroom</th>
      <th>Car</th>
      <th>Landsize</th>
      <th>Distancia_NEW</th>
      <th>Longtitude</th>
      <th>Lattitude</th>
      <th>Price</th>
      <th>precio_div</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20477</th>
      <td>5</td>
      <td>47.3</td>
      <td>2</td>
      <td>2</td>
      <td>756.0</td>
      <td>46.705427</td>
      <td>145.47282</td>
      <td>-38.08086</td>
      <td>490000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>23816</th>
      <td>4</td>
      <td>47.3</td>
      <td>2</td>
      <td>1</td>
      <td>799.0</td>
      <td>46.806014</td>
      <td>145.47790</td>
      <td>-38.07652</td>
      <td>571000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>27016</th>
      <td>4</td>
      <td>44.2</td>
      <td>2</td>
      <td>6</td>
      <td>720.0</td>
      <td>49.150316</td>
      <td>144.96232</td>
      <td>-37.40349</td>
      <td>565000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>19136</th>
      <td>3</td>
      <td>47.3</td>
      <td>2</td>
      <td>2</td>
      <td>648.0</td>
      <td>46.981723</td>
      <td>145.47262</td>
      <td>-38.08547</td>
      <td>493000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>21664</th>
      <td>4</td>
      <td>45.2</td>
      <td>2</td>
      <td>2</td>
      <td>23602.0</td>
      <td>47.991145</td>
      <td>145.52370</td>
      <td>-37.65220</td>
      <td>726000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>23274</th>
      <td>5</td>
      <td>44.2</td>
      <td>3</td>
      <td>2</td>
      <td>908.8</td>
      <td>49.449786</td>
      <td>145.00176</td>
      <td>-37.39780</td>
      <td>600000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>23276</th>
      <td>4</td>
      <td>44.2</td>
      <td>2</td>
      <td>2</td>
      <td>924.0</td>
      <td>49.578383</td>
      <td>144.96369</td>
      <td>-37.39946</td>
      <td>590000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>11188</th>
      <td>3</td>
      <td>45.2</td>
      <td>2</td>
      <td>4</td>
      <td>724.0</td>
      <td>48.465570</td>
      <td>145.52635</td>
      <td>-37.64685</td>
      <td>650000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>14487</th>
      <td>4</td>
      <td>47.3</td>
      <td>2</td>
      <td>2</td>
      <td>553.0</td>
      <td>47.807215</td>
      <td>145.48273</td>
      <td>-38.08699</td>
      <td>435000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>17077</th>
      <td>4</td>
      <td>47.3</td>
      <td>2</td>
      <td>2</td>
      <td>488.6</td>
      <td>48.306749</td>
      <td>145.51137</td>
      <td>-38.05934</td>
      <td>442000</td>
      <td>0</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cluster 2&quot;</span><span class="p">)</span>
<span class="n">close_to_far_from_center</span><span class="p">(</span><span class="n">X_new</span><span class="p">,</span><span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cluster 2
Close to center
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Rooms</th>
      <th>Distance</th>
      <th>Bathroom</th>
      <th>Car</th>
      <th>Landsize</th>
      <th>Distancia_NEW</th>
      <th>Longtitude</th>
      <th>Lattitude</th>
      <th>Price</th>
      <th>precio_div</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>22834</th>
      <td>4</td>
      <td>20.6</td>
      <td>2</td>
      <td>2</td>
      <td>399.0</td>
      <td>30.552464</td>
      <td>144.89019</td>
      <td>-37.59240</td>
      <td>640000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>13616</th>
      <td>4</td>
      <td>18.0</td>
      <td>2</td>
      <td>2</td>
      <td>724.0</td>
      <td>30.574344</td>
      <td>144.74850</td>
      <td>-37.68690</td>
      <td>660000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>18496</th>
      <td>4</td>
      <td>18.0</td>
      <td>2</td>
      <td>4</td>
      <td>643.0</td>
      <td>30.574770</td>
      <td>144.74576</td>
      <td>-37.69011</td>
      <td>707500</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>19447</th>
      <td>3</td>
      <td>20.6</td>
      <td>2</td>
      <td>2</td>
      <td>469.5</td>
      <td>30.552674</td>
      <td>144.89716</td>
      <td>-37.58993</td>
      <td>560000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>24580</th>
      <td>4</td>
      <td>20.6</td>
      <td>2</td>
      <td>2</td>
      <td>544.0</td>
      <td>30.636534</td>
      <td>144.90095</td>
      <td>-37.58783</td>
      <td>750000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>20097</th>
      <td>3</td>
      <td>20.6</td>
      <td>2</td>
      <td>2</td>
      <td>469.4</td>
      <td>30.564378</td>
      <td>144.92587</td>
      <td>-37.58113</td>
      <td>600000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>24043</th>
      <td>4</td>
      <td>20.6</td>
      <td>2</td>
      <td>2</td>
      <td>595.0</td>
      <td>30.647069</td>
      <td>144.90553</td>
      <td>-37.58624</td>
      <td>695000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>25797</th>
      <td>3</td>
      <td>20.6</td>
      <td>2</td>
      <td>2</td>
      <td>448.0</td>
      <td>30.636519</td>
      <td>144.92127</td>
      <td>-37.58168</td>
      <td>590000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>25083</th>
      <td>4</td>
      <td>20.6</td>
      <td>2</td>
      <td>2</td>
      <td>584.0</td>
      <td>30.615043</td>
      <td>144.93654</td>
      <td>-37.57800</td>
      <td>613500</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>25275</th>
      <td>4</td>
      <td>20.6</td>
      <td>2</td>
      <td>2</td>
      <td>512.0</td>
      <td>30.523868</td>
      <td>144.90065</td>
      <td>-37.58903</td>
      <td>662000</td>
      <td>0</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Far from center
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Rooms</th>
      <th>Distance</th>
      <th>Bathroom</th>
      <th>Car</th>
      <th>Landsize</th>
      <th>Distancia_NEW</th>
      <th>Longtitude</th>
      <th>Lattitude</th>
      <th>Price</th>
      <th>precio_div</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8155</th>
      <td>4</td>
      <td>4.6</td>
      <td>2</td>
      <td>2</td>
      <td>516.0</td>
      <td>0.485681</td>
      <td>145.030500</td>
      <td>-37.839800</td>
      <td>2620000</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8120</th>
      <td>3</td>
      <td>4.6</td>
      <td>1</td>
      <td>0</td>
      <td>1099.0</td>
      <td>0.417594</td>
      <td>145.030300</td>
      <td>-37.843800</td>
      <td>1635000</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8168</th>
      <td>2</td>
      <td>4.6</td>
      <td>1</td>
      <td>1</td>
      <td>0.0</td>
      <td>0.324376</td>
      <td>145.031300</td>
      <td>-37.841600</td>
      <td>690000</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>26010</th>
      <td>2</td>
      <td>5.9</td>
      <td>1</td>
      <td>1</td>
      <td>194.1</td>
      <td>0.216733</td>
      <td>145.035148</td>
      <td>-37.843318</td>
      <td>1310000</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>17021</th>
      <td>2</td>
      <td>5.9</td>
      <td>1</td>
      <td>2</td>
      <td>275.4</td>
      <td>0.216733</td>
      <td>145.036874</td>
      <td>-37.843399</td>
      <td>820000</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4742</th>
      <td>2</td>
      <td>6.2</td>
      <td>2</td>
      <td>2</td>
      <td>0.0</td>
      <td>0.210908</td>
      <td>145.034300</td>
      <td>-37.840700</td>
      <td>1290000</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4743</th>
      <td>3</td>
      <td>6.2</td>
      <td>1</td>
      <td>2</td>
      <td>363.1</td>
      <td>0.203503</td>
      <td>145.033978</td>
      <td>-37.842145</td>
      <td>1706000</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>26725</th>
      <td>4</td>
      <td>5.9</td>
      <td>4</td>
      <td>3</td>
      <td>630.0</td>
      <td>0.201492</td>
      <td>145.036430</td>
      <td>-37.843820</td>
      <td>2900000</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4741</th>
      <td>4</td>
      <td>6.2</td>
      <td>2</td>
      <td>3</td>
      <td>641.6</td>
      <td>0.200678</td>
      <td>145.035127</td>
      <td>-37.844022</td>
      <td>1815000</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>18042</th>
      <td>4</td>
      <td>5.9</td>
      <td>2</td>
      <td>3</td>
      <td>620.0</td>
      <td>0.174520</td>
      <td>145.033760</td>
      <td>-37.843910</td>
      <td>3080000</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>A priori, no se puede observar una gran relación entre la categorización que hemos realizado anteriormente con el precio y los cluster seleccionados habría que estudiar mas en profundidad estas relaciones.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#feature = &#39;Price&#39;</span>
<span class="c1">#col_number = feature_names.index(feature)</span>

<span class="c1">#plt.figure(figsize=(15,10))</span>
<span class="c1">#for l in np.unique(labels_km):</span>
    
    <span class="c1">#plt.subplot(2,5,l+1)</span>
    <span class="c1">#plt.hist(X[labels_km == l,col_number],bins = 50, density=True)</span>
    <span class="c1">#plt.xlabel(feature)</span>
    <span class="c1">#plt.title(&#39;Cluster #&#39; + str(l))</span>

<span class="c1">#plt.show()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="dbscan">
<h2>DBSCAN<a class="headerlink" href="#dbscan" title="Permalink to this headline">¶</a></h2>
<p>Usamos otra tecnica de clustering mas compleja  para corroborar la infrormacion obtenida anteriormente.</p>
<p>eps muy grande muy pocos clusters…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#from sklearn.cluster import DBSCAN</span>

<span class="c1">#for eps in [1, 3]: # 5, 7]:# a quui a dejado solo el 1 y 3 </span>
    <span class="c1">#print(&quot;\neps={}&quot;.format(eps))</span>
    <span class="c1">#dbscan = DBSCAN(eps=eps, min_samples=20)</span>
    <span class="c1">#labels = dbscan.fit_predict(Xs)</span>
    <span class="c1">#print(&quot;Number of clusters: {}&quot;.format(len(np.unique(labels))))</span>
    <span class="c1">#print(&quot;Cluster sizes: {}&quot;.format(np.bincount(labels + 1)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#from sklearn.cluster import DBSCAN</span>

<span class="c1">#for eps in [1, 3]: </span>
    <span class="c1">#print(&quot;\neps={}&quot;.format(eps))</span>
    <span class="c1">#dbscan = DBSCAN(eps=eps, min_samples=25)</span>
   <span class="c1"># labels = dbscan.fit_predict(Xs)</span>
    <span class="c1">#print(&quot;Number of clusters: {}&quot;.format(len(np.unique(labels))))</span>
    <span class="c1">#print(&quot;Cluster sizes: {}&quot;.format(np.bincount(labels + 1)))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="hierarchical-clustering">
<h2>Hierarchical clustering<a class="headerlink" href="#hierarchical-clustering" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#from scipy.cluster.hierarchy import dendrogram, linkage</span>

<span class="c1">#Z = linkage(X, &#39;average&#39;)</span>
<span class="c1">#dendrogram(Z)</span>
<span class="c1">#plt.show()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="1-DefinicionObjetivos.html" title="previous page">1. ANALISIS INICIAL</a>
    <a class='right-next' id="next-link" href="3-Reduccion_dimensionalidad.html" title="next page">3. Técnicas de reduccion de la dimensionalidad</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Ruven Valle, Jose Melero e Inmaculada Borrás<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>