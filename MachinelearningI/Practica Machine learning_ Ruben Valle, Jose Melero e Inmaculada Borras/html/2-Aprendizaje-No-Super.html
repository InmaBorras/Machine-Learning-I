
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2. Aprendizaje no supervisado &#8212; Práctica Machine Learning I</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3. Técnicas de reduccion de la dimensionalidad" href="3-Reduccion_dimensionalidad.html" />
    <link rel="prev" title="1. Analisis Inicial" href="1-DefinicionObjetivos.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/HH-Logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Práctica Machine Learning I</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="1-DefinicionObjetivos.html">
   1. Analisis Inicial
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   2. Aprendizaje no supervisado
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3-Reduccion_dimensionalidad.html">
   3. Técnicas de reduccion de la dimensionalidad
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4-Aprendizaje_supervisado.html">
   3. Aprendizaje Supervisado
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="5_Aprendizaje_supervisado_2.html">
   3.4. Random Forest y Decision Tree
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="5_Aprendizaje_supervisado_2.html#ajuste-de-hiperparametros">
   4. Ajuste de hiperparámetros
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6.Evaluacion_modelos.html">
   5. Evaluación de modelos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="7.Curva_ROC.html">
   6. Evaluacion del punto de mejor punto de corte
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/2-Aprendizaje-No-Super.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F2-Aprendizaje-No-Super.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/2-Aprendizaje-No-Super.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#objetivo">
   2.1.Objetivo
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="aprendizaje-no-supervisado">
<h1>2. Aprendizaje no supervisado<a class="headerlink" href="#aprendizaje-no-supervisado" title="Permalink to this headline">¶</a></h1>
<div class="section" id="objetivo">
<h2>2.1.Objetivo<a class="headerlink" href="#objetivo" title="Permalink to this headline">¶</a></h2>
<p>El objetivo de este apartado es comprobar como se hace una mejor “Clusterización” de los pisos usando KMeans. Intentaremos deducir si la mediana que (está en 875000 $) es un valor adecuado para catalogar un piso en caro o barato. Para ellos vamos a comparar los resultados de clusterizar usando Kmeans, empleando como entrada  tres variables obtendias mediante TSNE sobre el dataframente original. Después llevaremos a cabo lo mismo pero empleando las tres variables con más peso en relación al precio que se vieron en la práctica de de regresión lineal y como último paso añadiremos una cuarta variable, ya que tras algunas pruebas ha demostrado hacer una buena clasificacion de los pisos.</p>
<p>Cargamos las librerias que vamos a necesitar  y el archivo donde se encuetran las funiones que usaremos posteriormente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">mpatches</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sb</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="k">def</span> <span class="nf">close_to_far_from_center</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">centroid</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    
    <span class="n">distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">X</span> <span class="o">-</span> <span class="n">centroid</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Close to center&#39;</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">data_RF</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">distance</span><span class="p">)[:</span><span class="n">n</span><span class="p">]])</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Far from center&#39;</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">data_RF</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">distance</span><span class="p">)[</span><span class="o">-</span><span class="n">n</span><span class="p">:]])</span>

<span class="kn">from</span> <span class="nn">src.utils</span> <span class="kn">import</span> <span class="n">pd</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">plt</span>
<span class="kn">import</span>  <span class="nn">src.utils</span> 

<span class="c1"># Useful functions</span>
<span class="kn">from</span> <span class="nn">src.utils</span> <span class="kn">import</span> <span class="n">load_examples</span><span class="p">,</span> <span class="n">plot_scatter</span><span class="p">,</span> <span class="n">plot_silhouette</span>
</pre></div>
</div>
</div>
</div>
<p>Cargamos los datos con las variables del dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># cargamos los datos</span>

<span class="n">data_RF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;./CSV/seleccion_variables_RF_bathandrooms.csv&quot;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">data_RF</span> <span class="o">=</span> <span class="n">data_RF</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Rooms&#39;</span><span class="p">,</span><span class="s1">&#39;Distance&#39;</span><span class="p">,</span><span class="s1">&#39;Postcode&#39;</span><span class="p">,</span><span class="s1">&#39;Bathroom&#39;</span><span class="p">,</span><span class="s1">&#39;Car&#39;</span><span class="p">,</span><span class="s1">&#39;Landsize&#39;</span><span class="p">,</span><span class="s1">&#39;Propertycount&#39;</span><span class="p">,</span><span class="s1">&#39;Distancia_NEW&#39;</span><span class="p">,</span><span class="s1">&#39;Longtitude&#39;</span><span class="p">,</span><span class="s1">&#39;Lattitude&#39;</span><span class="p">,</span><span class="s1">&#39;Location_TRA&#39;</span><span class="p">,</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span>
<span class="n">data_RF</span><span class="o">=</span><span class="n">data_RF</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span>
<span class="c1">#ponemos la columna precio al final</span>

<span class="n">data_RF</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">data_RF</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Rooms</th>
      <th>Distance</th>
      <th>Postcode</th>
      <th>Bathroom</th>
      <th>Car</th>
      <th>Landsize</th>
      <th>Propertycount</th>
      <th>Distancia_NEW</th>
      <th>Longtitude</th>
      <th>Lattitude</th>
      <th>Location_TRA</th>
      <th>Price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>27056.000000</td>
      <td>27056.000000</td>
      <td>27056.000000</td>
      <td>27056.000000</td>
      <td>27056.000000</td>
      <td>27056.000000</td>
      <td>27056.000000</td>
      <td>27056.000000</td>
      <td>27056.000000</td>
      <td>27056.000000</td>
      <td>27056.000000</td>
      <td>2.705600e+04</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.994530</td>
      <td>11.314033</td>
      <td>3114.204590</td>
      <td>1.552262</td>
      <td>1.667431</td>
      <td>612.205509</td>
      <td>7573.720166</td>
      <td>11.952305</td>
      <td>145.008020</td>
      <td>-37.808097</td>
      <td>3.835397</td>
      <td>1.053621e+06</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.950429</td>
      <td>6.799548</td>
      <td>111.501632</td>
      <td>0.675360</td>
      <td>0.918234</td>
      <td>3249.934429</td>
      <td>4496.112130</td>
      <td>7.849907</td>
      <td>0.111148</td>
      <td>0.083232</td>
      <td>0.007949</td>
      <td>6.432746e+05</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>3000.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>83.000000</td>
      <td>0.174520</td>
      <td>144.540220</td>
      <td>-38.190430</td>
      <td>3.800381</td>
      <td>8.500000e+04</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.000000</td>
      <td>6.400000</td>
      <td>3046.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>264.000000</td>
      <td>4294.000000</td>
      <td>6.007600</td>
      <td>144.950700</td>
      <td>-37.852207</td>
      <td>3.831049</td>
      <td>6.400000e+05</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3.000000</td>
      <td>10.500000</td>
      <td>3088.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>509.000000</td>
      <td>6567.000000</td>
      <td>10.276541</td>
      <td>145.016100</td>
      <td>-37.807955</td>
      <td>3.835749</td>
      <td>8.750000e+05</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4.000000</td>
      <td>14.000000</td>
      <td>3155.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>661.000000</td>
      <td>10412.000000</td>
      <td>15.780575</td>
      <td>145.068500</td>
      <td>-37.760771</td>
      <td>3.839746</td>
      <td>1.300000e+06</td>
    </tr>
    <tr>
      <th>max</th>
      <td>16.000000</td>
      <td>48.100000</td>
      <td>3978.000000</td>
      <td>9.000000</td>
      <td>18.000000</td>
      <td>433014.000000</td>
      <td>21650.000000</td>
      <td>49.578383</td>
      <td>145.526350</td>
      <td>-37.397800</td>
      <td>3.877280</td>
      <td>1.120000e+07</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>No contamos con variables cualitativas.</p>
<p>Añadimos una columna adicional categorica para clasificar el precio como hemos visto en el analisis anterior donde dividimos las casa en cara y baratas en funcion de la mediana.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>-Casas caras como 1
-Casas baratas como 0 
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="c1">#Eliminamos columnas que podrían considerarse como categoricas a pesar de ser numericas</span>
<span class="c1">#PostCode y PropertyCount</span>

<span class="c1">#añadimos una columna adicional categorica para clasificar el precio</span>

<span class="n">intervalos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_RF</span><span class="p">[[</span><span class="s1">&#39;Price&#39;</span><span class="p">]]),[</span><span class="mi">875000</span><span class="p">])</span>
<span class="n">data_RF</span><span class="p">[[</span><span class="s1">&#39;cat_precio&#39;</span><span class="p">]]</span><span class="o">=</span><span class="n">intervalos</span>

<span class="c1"># convertimos el DataFrame al formato necesario para scikit-learn</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_RF</span><span class="p">[[</span><span class="s1">&#39;Rooms&#39;</span><span class="p">,</span><span class="s1">&#39;Distance&#39;</span><span class="p">,</span><span class="s1">&#39;Bathroom&#39;</span><span class="p">,</span><span class="s1">&#39;Car&#39;</span><span class="p">,</span><span class="s1">&#39;Landsize&#39;</span><span class="p">,</span><span class="s1">&#39;Distancia_NEW&#39;</span><span class="p">,</span><span class="s1">&#39;Longtitude&#39;</span><span class="p">,</span><span class="s1">&#39;Lattitude&#39;</span><span class="p">,</span><span class="s1">&#39;Price&#39;</span><span class="p">,</span><span class="s1">&#39;cat_precio&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="n">y_price</span><span class="o">=</span><span class="n">data</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_RF</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rooms              int64
Distance         float64
Postcode         float64
Bathroom           int64
Car                int64
Landsize         float64
Propertycount    float64
Distancia_NEW    float64
Longtitude       float64
Lattitude        float64
Location_TRA     float64
Price              int64
cat_precio         int64
dtype: object
</pre></div>
</div>
</div>
</div>
<p>El objetivo de este apartado es comprobar como se hace una mejor “Clusterizacion” de los pisos usando KMeans. Vamos a compàrar los resultados de clusterizar usando Kmeans al que se le va a pasar tres variables obtendias mediante TSNE sobre el dataframente original y llevaremos a cabo lo mismo pero empleando las tres variables con mas peso en relacion al precio que se vieron en la practica de de regresion lineal,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> 
<span class="c1">#X = data[:,7:-2]    # nos quedamos con el resto</span>
<span class="c1">#X = data[]</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="n">data_RF</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">Xs</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">data_RF</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="n">y_price</span>

<span class="kn">from</span> <span class="nn">sklearn.manifold</span> <span class="kn">import</span> <span class="n">TSNE</span>

<span class="c1">#Take a sample and plot it</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">random_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">Xs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">N</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">X_tsne</span> <span class="o">=</span> <span class="n">TSNE</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">perplexity</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">Xs</span><span class="p">[</span><span class="n">random_idx</span><span class="p">,:])</span>
<span class="n">X_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_RF</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">X_new</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<p>Vamos a hacer una vistualización de ambos dataframes, el que tiene tres variables obtenidas mediante TSNE y las tres variables con mas peso del Dataframe original:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">Axes3D</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="n">colores</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span><span class="s1">&#39;orange&#39;</span><span class="p">]</span>
<span class="n">asignar</span><span class="o">=</span><span class="p">[]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_price</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">y_pintar</span><span class="o">=</span><span class="n">y_price</span><span class="p">[</span><span class="n">random_idx</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_pintar</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">y_pintar</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">):</span>
    <span class="n">asignar</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">colores</span><span class="p">[</span><span class="n">row</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;TSNE&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_tsne</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_tsne</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">X_tsne</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">asignar</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Pintamos Dataframe original</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">Axes3D</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="n">colores</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span><span class="s1">&#39;orange&#39;</span><span class="p">]</span>
<span class="n">asignar</span><span class="o">=</span><span class="p">[]</span>
<span class="n">y_pintar</span><span class="o">=</span><span class="n">y_price</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">y_pintar</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">):</span>
    <span class="n">asignar</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">colores</span><span class="p">[</span><span class="n">row</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Variables&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_new</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">X_new</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">X_new</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">asignar</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No handles with labels found to put in legend.
No handles with labels found to put in legend.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
[1. 1. 0. ... 0. 0. 0.]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;mpl_toolkits.mplot3d.art3d.Path3DCollection at 0x7f8c19fd4e50&gt;
</pre></div>
</div>
<img alt="_images/2-Aprendizaje-No-Super_10_3.png" src="_images/2-Aprendizaje-No-Super_10_3.png" />
<img alt="_images/2-Aprendizaje-No-Super_10_4.png" src="_images/2-Aprendizaje-No-Super_10_4.png" />
</div>
</div>
<p>Como se puede puede ver en las figuras anteriores la relacion con el precio es claramente interpretable en las tres variables directas del dataframe original, no ocurre lo mismo con las variables obtenidas de TSNE. Cabe suponer que si alguno de los dos dataframe nos sirve para hacer clustering que tengan relacion con el precio este será el que llevemos a cabo con el dataframe original.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>


<span class="c1">#Inertia para TSNE</span>
<span class="n">K</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="n">inertia</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">K</span><span class="p">:</span>
    <span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_tsne</span><span class="p">)</span>
    <span class="n">inertia</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kmeans</span><span class="o">.</span><span class="n">inertia_</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">inertia</span><span class="p">,</span><span class="s1">&#39;.-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Cálculo de número de cluster óptimo para dataframe TSNE &#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;# of clusters&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Inertia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>



<span class="c1">#Inertia para Dataframe original</span>
<span class="n">K</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="n">inertia</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">K</span><span class="p">:</span>
    <span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_new</span><span class="p">)</span>
    <span class="n">inertia</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kmeans</span><span class="o">.</span><span class="n">inertia_</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">inertia</span><span class="p">,</span><span class="s1">&#39;.-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Cálculo de número de cluster óptimo para dataframe Original &#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;# of clusters&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Inertia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2-Aprendizaje-No-Super_12_0.png" src="_images/2-Aprendizaje-No-Super_12_0.png" />
<img alt="_images/2-Aprendizaje-No-Super_12_1.png" src="_images/2-Aprendizaje-No-Super_12_1.png" />
</div>
</div>
<p>Vamos a crear el cluster en primer lugar ambos cluster uno con TSNE y el otro con variables originales y optimizaremos el numero de agrupaciones en cada uno de ellos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k_TSNE</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">kmeans_TSNE</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k_TSNE</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">labels_km_TSNE</span> <span class="o">=</span> <span class="n">kmeans_TSNE</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X_tsne</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cluster sizes k-means: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">labels_km_TSNE</span><span class="p">)))</span>

<span class="n">distances_TSNE</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">kmeans_TSNE</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">:</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">X_tsne</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> 
    <span class="n">distances_TSNE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cluster distances k-means: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances_TSNE</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">k_TSNE</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">labels_km_TSNE</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">k_TSNE</span><span class="p">),</span><span class="n">distances_TSNE</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plot_silhouette</span><span class="p">(</span><span class="n">X_tsne</span><span class="p">,</span><span class="n">k_TSNE</span><span class="p">,</span><span class="n">kmeans_TSNE</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span><span class="n">kmeans_TSNE</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cluster sizes k-means: [738 887 636 684 769 664 622]
Cluster distances k-means: [3679857.5, 3031114.0, 3384590.5, 3247705.5, 2805486.8, 3853161.5, 2847426.5]
</pre></div>
</div>
<img alt="_images/2-Aprendizaje-No-Super_14_1.png" src="_images/2-Aprendizaje-No-Super_14_1.png" />
<img alt="_images/2-Aprendizaje-No-Super_14_2.png" src="_images/2-Aprendizaje-No-Super_14_2.png" />
</div>
</div>
<p>En el caso de TSNE parece que <strong>la mejor agrupacióon nos la hace con K =7 ( 7 clusters)</strong>.</p>
<p>Pasamos a hacer los mismo con las variables del Dataframe original.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">labels_km</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X_new</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cluster sizes k-means: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">labels_km</span><span class="p">)))</span>

<span class="n">distances</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">:</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">X_new</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> 
    <span class="n">distances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cluster distances k-means: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">labels_km</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="n">distances</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plot_silhouette</span><span class="p">(</span><span class="n">X_new</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span><span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cluster sizes k-means: [14753 10013  2290]
Cluster distances k-means: [2484415.34, 2069834.93, 11057235.12]
</pre></div>
</div>
<img alt="_images/2-Aprendizaje-No-Super_16_1.png" src="_images/2-Aprendizaje-No-Super_16_1.png" />
<img alt="_images/2-Aprendizaje-No-Super_16_2.png" src="_images/2-Aprendizaje-No-Super_16_2.png" />
</div>
</div>
<p>En el caso de la agrupación variables originales parece que <strong>la mejor agrupacióon nos la hace con K =3 ( 3 clusters)</strong>.</p>
<p>Una vez creados los cluster vamos estudiar qué contiene cada uno de ellos</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sb</span>

<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">Axes3D</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="n">colores</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;blue&#39;</span><span class="p">]</span>
<span class="n">asignarx</span><span class="o">=</span><span class="p">[]</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">labels_km</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">):</span>
    <span class="n">asignarx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">colores</span><span class="p">[</span><span class="n">row</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_new</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">X_new</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">X_new</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">asignarx</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;mpl_toolkits.mplot3d.art3d.Path3DCollection at 0x7f8c040ce290&gt;
</pre></div>
</div>
<img alt="_images/2-Aprendizaje-No-Super_18_1.png" src="_images/2-Aprendizaje-No-Super_18_1.png" />
</div>
</div>
<p>Como se puede puede parece que los tres cluster llevados a cabo han tenido en cuenta perfectamente las variables por lo que cabe espera que la relacion con el precio sea buena.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_RF</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">labels_km</span>
<span class="n">sb</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">data_RF</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;cluster&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Lattitude&quot;</span><span class="p">,</span><span class="s2">&quot;Distancia_NEW&quot;</span><span class="p">,</span><span class="s2">&quot;Longtitude&quot;</span><span class="p">,</span><span class="s2">&quot;cat_precio&quot;</span><span class="p">],</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.PairGrid at 0x7f8c04028ed0&gt;
</pre></div>
</div>
<img alt="_images/2-Aprendizaje-No-Super_20_1.png" src="_images/2-Aprendizaje-No-Super_20_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;elementos mas cercanos y mas lejanos del cluster 0&quot;</span><span class="p">)</span>
<span class="n">close_to_far_from_center</span><span class="p">(</span><span class="n">X_new</span><span class="p">,</span><span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>elementos mas cercanos y mas lejanos del cluster 0
Close to center
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Rooms</th>
      <th>Distance</th>
      <th>Postcode</th>
      <th>Bathroom</th>
      <th>Car</th>
      <th>Landsize</th>
      <th>Propertycount</th>
      <th>Distancia_NEW</th>
      <th>Longtitude</th>
      <th>Lattitude</th>
      <th>Location_TRA</th>
      <th>Price</th>
      <th>cat_precio</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9533</th>
      <td>3</td>
      <td>13.9</td>
      <td>3165.0</td>
      <td>1</td>
      <td>2</td>
      <td>638.0</td>
      <td>10969.0</td>
      <td>6.455055</td>
      <td>145.037911</td>
      <td>-37.811033</td>
      <td>3.836785</td>
      <td>1050000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12375</th>
      <td>3</td>
      <td>18.4</td>
      <td>3029.0</td>
      <td>1</td>
      <td>2</td>
      <td>515.8</td>
      <td>10160.0</td>
      <td>6.442608</td>
      <td>145.031103</td>
      <td>-37.812137</td>
      <td>3.836425</td>
      <td>545000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1133</th>
      <td>4</td>
      <td>13.9</td>
      <td>3165.0</td>
      <td>2</td>
      <td>2</td>
      <td>364.6</td>
      <td>10969.0</td>
      <td>6.452788</td>
      <td>145.049978</td>
      <td>-37.809721</td>
      <td>3.837283</td>
      <td>1235000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1260</th>
      <td>4</td>
      <td>13.9</td>
      <td>3165.0</td>
      <td>2</td>
      <td>2</td>
      <td>364.6</td>
      <td>10969.0</td>
      <td>6.452788</td>
      <td>145.049978</td>
      <td>-37.809721</td>
      <td>3.837283</td>
      <td>1235000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5943</th>
      <td>4</td>
      <td>9.9</td>
      <td>3044.0</td>
      <td>2</td>
      <td>2</td>
      <td>490.3</td>
      <td>7485.0</td>
      <td>6.452338</td>
      <td>145.037719</td>
      <td>-37.801243</td>
      <td>3.836918</td>
      <td>900000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2711</th>
      <td>2</td>
      <td>9.2</td>
      <td>3058.0</td>
      <td>1</td>
      <td>2</td>
      <td>2130.4</td>
      <td>3445.0</td>
      <td>6.446261</td>
      <td>145.023328</td>
      <td>-37.798137</td>
      <td>3.836998</td>
      <td>830000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>21349</th>
      <td>1</td>
      <td>6.3</td>
      <td>3013.0</td>
      <td>1</td>
      <td>1</td>
      <td>110.7</td>
      <td>6543.0</td>
      <td>6.464547</td>
      <td>145.025140</td>
      <td>-37.793561</td>
      <td>3.837072</td>
      <td>312000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1265</th>
      <td>6</td>
      <td>13.9</td>
      <td>3165.0</td>
      <td>3</td>
      <td>3</td>
      <td>590.2</td>
      <td>10969.0</td>
      <td>6.470239</td>
      <td>145.056329</td>
      <td>-37.854979</td>
      <td>3.831685</td>
      <td>1300000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>18764</th>
      <td>2</td>
      <td>4.3</td>
      <td>3032.0</td>
      <td>1</td>
      <td>1</td>
      <td>979.9</td>
      <td>6567.0</td>
      <td>6.443454</td>
      <td>145.009735</td>
      <td>-37.798933</td>
      <td>3.835737</td>
      <td>560000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7503</th>
      <td>4</td>
      <td>9.7</td>
      <td>3041.0</td>
      <td>2</td>
      <td>2</td>
      <td>511.1</td>
      <td>3284.0</td>
      <td>6.436502</td>
      <td>145.060570</td>
      <td>-37.809797</td>
      <td>3.837551</td>
      <td>1055000</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Far from center
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Rooms</th>
      <th>Distance</th>
      <th>Postcode</th>
      <th>Bathroom</th>
      <th>Car</th>
      <th>Landsize</th>
      <th>Propertycount</th>
      <th>Distancia_NEW</th>
      <th>Longtitude</th>
      <th>Lattitude</th>
      <th>Location_TRA</th>
      <th>Price</th>
      <th>cat_precio</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20214</th>
      <td>3</td>
      <td>45.9</td>
      <td>3437.0</td>
      <td>2</td>
      <td>4</td>
      <td>40468.0</td>
      <td>290.0</td>
      <td>48.231807</td>
      <td>144.63257</td>
      <td>-37.54812</td>
      <td>3.851926</td>
      <td>930000</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>17077</th>
      <td>4</td>
      <td>47.3</td>
      <td>3810.0</td>
      <td>2</td>
      <td>2</td>
      <td>488.6</td>
      <td>17384.0</td>
      <td>48.306749</td>
      <td>145.51137</td>
      <td>-38.05934</td>
      <td>3.823276</td>
      <td>442000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>23275</th>
      <td>3</td>
      <td>44.2</td>
      <td>3756.0</td>
      <td>1</td>
      <td>1</td>
      <td>555.5</td>
      <td>3988.0</td>
      <td>48.416964</td>
      <td>144.97782</td>
      <td>-37.40869</td>
      <td>3.875512</td>
      <td>390000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>16710</th>
      <td>3</td>
      <td>44.2</td>
      <td>3756.0</td>
      <td>1</td>
      <td>1</td>
      <td>502.0</td>
      <td>3988.0</td>
      <td>48.437659</td>
      <td>144.97749</td>
      <td>-37.40853</td>
      <td>3.875520</td>
      <td>366000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>11188</th>
      <td>3</td>
      <td>45.2</td>
      <td>3777.0</td>
      <td>2</td>
      <td>4</td>
      <td>724.0</td>
      <td>3307.0</td>
      <td>48.465570</td>
      <td>145.52635</td>
      <td>-37.64685</td>
      <td>3.865565</td>
      <td>650000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>25562</th>
      <td>4</td>
      <td>44.2</td>
      <td>3756.0</td>
      <td>2</td>
      <td>2</td>
      <td>757.0</td>
      <td>3988.0</td>
      <td>48.509563</td>
      <td>144.98302</td>
      <td>-37.40744</td>
      <td>3.875780</td>
      <td>560000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>20801</th>
      <td>3</td>
      <td>44.2</td>
      <td>3756.0</td>
      <td>1</td>
      <td>2</td>
      <td>679.0</td>
      <td>3988.0</td>
      <td>48.599281</td>
      <td>144.97590</td>
      <td>-37.40720</td>
      <td>3.875615</td>
      <td>411000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>27016</th>
      <td>4</td>
      <td>44.2</td>
      <td>3756.0</td>
      <td>2</td>
      <td>6</td>
      <td>720.0</td>
      <td>3988.0</td>
      <td>49.150316</td>
      <td>144.96232</td>
      <td>-37.40349</td>
      <td>3.875636</td>
      <td>565000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>23274</th>
      <td>5</td>
      <td>44.2</td>
      <td>3756.0</td>
      <td>3</td>
      <td>2</td>
      <td>908.8</td>
      <td>3988.0</td>
      <td>49.449786</td>
      <td>145.00176</td>
      <td>-37.39780</td>
      <td>3.877280</td>
      <td>600000</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>23276</th>
      <td>4</td>
      <td>44.2</td>
      <td>3756.0</td>
      <td>2</td>
      <td>2</td>
      <td>924.0</td>
      <td>3988.0</td>
      <td>49.578383</td>
      <td>144.96369</td>
      <td>-37.39946</td>
      <td>3.876090</td>
      <td>590000</td>
      <td>0</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Vamos a ver las variables estadisticas mas importante de cada cluster:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_RF</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;cluster&#39;</span><span class="p">)[</span><span class="s2">&quot;cat_precio&quot;</span><span class="p">,</span><span class="s2">&quot;Price&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="8" halign="left">cat_precio</th>
      <th colspan="8" halign="left">Price</th>
    </tr>
    <tr>
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>cluster</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>14753.0</td>
      <td>0.600895</td>
      <td>0.489731</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>14753.0</td>
      <td>1.213609e+06</td>
      <td>757576.607162</td>
      <td>112000.0</td>
      <td>680000.0</td>
      <td>1041000.0</td>
      <td>1525000.0</td>
      <td>11200000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10013.0</td>
      <td>0.449715</td>
      <td>0.497490</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>10013.0</td>
      <td>9.140778e+05</td>
      <td>408364.004186</td>
      <td>85000.0</td>
      <td>655000.0</td>
      <td>835000.0</td>
      <td>1075000.0</td>
      <td>9000000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2290.0</td>
      <td>0.080349</td>
      <td>0.271893</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>2290.0</td>
      <td>6.330686e+05</td>
      <td>188911.480002</td>
      <td>266000.0</td>
      <td>515000.0</td>
      <td>601000.0</td>
      <td>705000.0</td>
      <td>2300000.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>El cluster 2 los mas baratos</strong> ya que mas del 75 % de los elementos de ese cluster están clasificados como baratos. en el otro extremo está el <strong>cluster 0 donde mas del 50% de los pisos son caros</strong></p>
<p><strong>pasamos a hacer la misma comprobacion pero para el dataframe extraido de TSNE</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sb</span>

<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">Axes3D</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="n">colores</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="s1">&#39;black&#39;</span><span class="p">]</span>
<span class="n">asignarx_tsne</span><span class="o">=</span><span class="p">[]</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">labels_km_TSNE</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">):</span>
    <span class="n">asignarx_tsne</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">colores</span><span class="p">[</span><span class="n">row</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_tsne</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">X_tsne</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">X_tsne</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">asignarx_tsne</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;mpl_toolkits.mplot3d.art3d.Path3DCollection at 0x7f8bfc30c650&gt;
</pre></div>
</div>
<img alt="_images/2-Aprendizaje-No-Super_26_1.png" src="_images/2-Aprendizaje-No-Super_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_RF_xs</span><span class="o">=</span><span class="n">data_RF</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">random_idx</span><span class="p">]</span>
<span class="n">data_RF_xs</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">labels_km_TSNE</span>

<span class="n">sb</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">data_RF_xs</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;cluster&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Lattitude&quot;</span><span class="p">,</span><span class="s2">&quot;Distancia_NEW&quot;</span><span class="p">,</span><span class="s2">&quot;Longtitude&quot;</span><span class="p">,</span><span class="s2">&quot;cat_precio&quot;</span><span class="p">],</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.PairGrid at 0x7f8bfc2ce950&gt;
</pre></div>
</div>
<img alt="_images/2-Aprendizaje-No-Super_27_1.png" src="_images/2-Aprendizaje-No-Super_27_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;elementos mas cercanos y mas lejanos del cluster 0&quot;</span><span class="p">)</span>
<span class="n">close_to_far_from_center</span><span class="p">(</span><span class="n">X_tsne</span><span class="p">,</span><span class="n">kmeans_TSNE</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>elementos mas cercanos y mas lejanos del cluster 0
Close to center
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Rooms</th>
      <th>Distance</th>
      <th>Postcode</th>
      <th>Bathroom</th>
      <th>Car</th>
      <th>Landsize</th>
      <th>Propertycount</th>
      <th>Distancia_NEW</th>
      <th>Longtitude</th>
      <th>Lattitude</th>
      <th>Location_TRA</th>
      <th>Price</th>
      <th>cat_precio</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4070</th>
      <td>1</td>
      <td>4.6</td>
      <td>3122.0</td>
      <td>1</td>
      <td>1</td>
      <td>0.0</td>
      <td>11308.0</td>
      <td>3.651682</td>
      <td>145.017100</td>
      <td>-37.81280</td>
      <td>3.835133</td>
      <td>480000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>356</th>
      <td>3</td>
      <td>6.3</td>
      <td>3143.0</td>
      <td>2</td>
      <td>1</td>
      <td>316.0</td>
      <td>4836.0</td>
      <td>1.746361</td>
      <td>145.019000</td>
      <td>-37.85210</td>
      <td>3.831201</td>
      <td>2365000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3749</th>
      <td>3</td>
      <td>13.0</td>
      <td>3046.0</td>
      <td>2</td>
      <td>1</td>
      <td>190.0</td>
      <td>8870.0</td>
      <td>18.058280</td>
      <td>144.936700</td>
      <td>-37.69970</td>
      <td>3.844505</td>
      <td>460000</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3937</th>
      <td>3</td>
      <td>13.7</td>
      <td>3188.0</td>
      <td>2</td>
      <td>1</td>
      <td>401.8</td>
      <td>5454.0</td>
      <td>3.434537</td>
      <td>145.008314</td>
      <td>-37.83325</td>
      <td>3.832939</td>
      <td>1271000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3315</th>
      <td>2</td>
      <td>3.5</td>
      <td>3068.0</td>
      <td>1</td>
      <td>2</td>
      <td>0.0</td>
      <td>6244.0</td>
      <td>7.281155</td>
      <td>144.982400</td>
      <td>-37.79180</td>
      <td>3.836345</td>
      <td>675000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3565</th>
      <td>2</td>
      <td>9.2</td>
      <td>3146.0</td>
      <td>1</td>
      <td>1</td>
      <td>0.0</td>
      <td>10412.0</td>
      <td>1.938587</td>
      <td>145.049000</td>
      <td>-37.85590</td>
      <td>3.831609</td>
      <td>480000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1396</th>
      <td>3</td>
      <td>11.2</td>
      <td>3186.0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>10579.0</td>
      <td>10.372661</td>
      <td>144.993500</td>
      <td>-37.93010</td>
      <td>3.822650</td>
      <td>1900000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2046</th>
      <td>4</td>
      <td>11.7</td>
      <td>3125.0</td>
      <td>2</td>
      <td>2</td>
      <td>499.0</td>
      <td>5678.0</td>
      <td>6.884333</td>
      <td>145.110100</td>
      <td>-37.85930</td>
      <td>3.832879</td>
      <td>1250000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1160</th>
      <td>4</td>
      <td>13.9</td>
      <td>3165.0</td>
      <td>2</td>
      <td>2</td>
      <td>618.0</td>
      <td>10969.0</td>
      <td>9.363937</td>
      <td>145.056200</td>
      <td>-37.92520</td>
      <td>3.824797</td>
      <td>1352000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1488</th>
      <td>4</td>
      <td>11.2</td>
      <td>3186.0</td>
      <td>2</td>
      <td>2</td>
      <td>471.0</td>
      <td>10579.0</td>
      <td>6.491109</td>
      <td>145.003700</td>
      <td>-37.89560</td>
      <td>3.826399</td>
      <td>2000000</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Far from center
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Rooms</th>
      <th>Distance</th>
      <th>Postcode</th>
      <th>Bathroom</th>
      <th>Car</th>
      <th>Landsize</th>
      <th>Propertycount</th>
      <th>Distancia_NEW</th>
      <th>Longtitude</th>
      <th>Lattitude</th>
      <th>Location_TRA</th>
      <th>Price</th>
      <th>cat_precio</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3211</th>
      <td>2</td>
      <td>5.8</td>
      <td>3078.0</td>
      <td>1</td>
      <td>1</td>
      <td>0.0</td>
      <td>2970.0</td>
      <td>7.592068</td>
      <td>145.017800</td>
      <td>-37.775500</td>
      <td>3.838938</td>
      <td>505000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1809</th>
      <td>3</td>
      <td>5.2</td>
      <td>3056.0</td>
      <td>1</td>
      <td>1</td>
      <td>480.0</td>
      <td>11918.0</td>
      <td>6.828452</td>
      <td>145.029500</td>
      <td>-37.903940</td>
      <td>3.826238</td>
      <td>1317000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2839</th>
      <td>3</td>
      <td>13.9</td>
      <td>3108.0</td>
      <td>2</td>
      <td>2</td>
      <td>0.0</td>
      <td>9028.0</td>
      <td>10.604569</td>
      <td>145.127300</td>
      <td>-37.781400</td>
      <td>3.841237</td>
      <td>958000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>285</th>
      <td>3</td>
      <td>11.1</td>
      <td>3025.0</td>
      <td>1</td>
      <td>2</td>
      <td>600.6</td>
      <td>5132.0</td>
      <td>5.152254</td>
      <td>145.028777</td>
      <td>-37.823359</td>
      <td>3.835045</td>
      <td>765000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4633</th>
      <td>4</td>
      <td>5.6</td>
      <td>3101.0</td>
      <td>1</td>
      <td>2</td>
      <td>832.0</td>
      <td>10331.0</td>
      <td>4.659992</td>
      <td>145.054500</td>
      <td>-37.803600</td>
      <td>3.837055</td>
      <td>2513000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2870</th>
      <td>3</td>
      <td>13.9</td>
      <td>3108.0</td>
      <td>2</td>
      <td>2</td>
      <td>353.9</td>
      <td>9028.0</td>
      <td>8.651773</td>
      <td>145.112300</td>
      <td>-37.792570</td>
      <td>3.839676</td>
      <td>901000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2424</th>
      <td>2</td>
      <td>9.3</td>
      <td>3162.0</td>
      <td>1</td>
      <td>1</td>
      <td>367.0</td>
      <td>5051.0</td>
      <td>6.389295</td>
      <td>145.024100</td>
      <td>-37.899500</td>
      <td>3.826544</td>
      <td>825000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2516</th>
      <td>3</td>
      <td>3.4</td>
      <td>3068.0</td>
      <td>3</td>
      <td>1</td>
      <td>994.8</td>
      <td>2954.0</td>
      <td>6.221548</td>
      <td>144.998300</td>
      <td>-37.794306</td>
      <td>3.836511</td>
      <td>841000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3742</th>
      <td>3</td>
      <td>13.0</td>
      <td>3046.0</td>
      <td>1</td>
      <td>1</td>
      <td>796.0</td>
      <td>8870.0</td>
      <td>18.959820</td>
      <td>144.925300</td>
      <td>-37.695500</td>
      <td>3.844631</td>
      <td>710000</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2938</th>
      <td>3</td>
      <td>8.5</td>
      <td>3185.0</td>
      <td>1</td>
      <td>1</td>
      <td>418.0</td>
      <td>4898.0</td>
      <td>4.814966</td>
      <td>145.015300</td>
      <td>-37.883100</td>
      <td>3.827968</td>
      <td>1605000</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;elementos mas cercanos y mas lejanos del cluster 1&quot;</span><span class="p">)</span>
<span class="n">close_to_far_from_center</span><span class="p">(</span><span class="n">X_tsne</span><span class="p">,</span><span class="n">kmeans_TSNE</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>elementos mas cercanos y mas lejanos del cluster 1
Close to center
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Rooms</th>
      <th>Distance</th>
      <th>Postcode</th>
      <th>Bathroom</th>
      <th>Car</th>
      <th>Landsize</th>
      <th>Propertycount</th>
      <th>Distancia_NEW</th>
      <th>Longtitude</th>
      <th>Lattitude</th>
      <th>Location_TRA</th>
      <th>Price</th>
      <th>cat_precio</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3007</th>
      <td>3</td>
      <td>7.7</td>
      <td>3184.0</td>
      <td>2</td>
      <td>0</td>
      <td>218.0</td>
      <td>8989.0</td>
      <td>6.084341</td>
      <td>144.979800</td>
      <td>-37.875800</td>
      <td>3.827769</td>
      <td>1561000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1569</th>
      <td>3</td>
      <td>10.7</td>
      <td>3187.0</td>
      <td>1</td>
      <td>1</td>
      <td>490.0</td>
      <td>6938.0</td>
      <td>6.998676</td>
      <td>145.009700</td>
      <td>-37.902400</td>
      <td>3.825871</td>
      <td>1405000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>934</th>
      <td>4</td>
      <td>13.0</td>
      <td>3204.0</td>
      <td>3</td>
      <td>2</td>
      <td>628.0</td>
      <td>6795.0</td>
      <td>8.109249</td>
      <td>145.040100</td>
      <td>-37.915500</td>
      <td>3.825351</td>
      <td>2700000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3411</th>
      <td>4</td>
      <td>6.4</td>
      <td>3011.0</td>
      <td>1</td>
      <td>2</td>
      <td>411.0</td>
      <td>7570.0</td>
      <td>12.508303</td>
      <td>144.904900</td>
      <td>-37.796900</td>
      <td>3.833777</td>
      <td>1290000</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3501</th>
      <td>3</td>
      <td>9.2</td>
      <td>3146.0</td>
      <td>2</td>
      <td>2</td>
      <td>273.6</td>
      <td>10412.0</td>
      <td>2.743096</td>
      <td>145.062493</td>
      <td>-37.850952</td>
      <td>3.832391</td>
      <td>1155000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3649</th>
      <td>3</td>
      <td>13.0</td>
      <td>3046.0</td>
      <td>1</td>
      <td>1</td>
      <td>336.0</td>
      <td>8870.0</td>
      <td>17.226895</td>
      <td>144.935600</td>
      <td>-37.708800</td>
      <td>3.843548</td>
      <td>500000</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3874</th>
      <td>3</td>
      <td>13.7</td>
      <td>3188.0</td>
      <td>2</td>
      <td>3</td>
      <td>1402.0</td>
      <td>5454.0</td>
      <td>10.772451</td>
      <td>144.996300</td>
      <td>-37.934700</td>
      <td>3.822260</td>
      <td>2200000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3486</th>
      <td>2</td>
      <td>6.4</td>
      <td>3011.0</td>
      <td>1</td>
      <td>1</td>
      <td>355.0</td>
      <td>7570.0</td>
      <td>13.572995</td>
      <td>144.893800</td>
      <td>-37.793100</td>
      <td>3.833869</td>
      <td>745000</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1103</th>
      <td>4</td>
      <td>13.9</td>
      <td>3165.0</td>
      <td>2</td>
      <td>4</td>
      <td>653.0</td>
      <td>10969.0</td>
      <td>9.888454</td>
      <td>145.079200</td>
      <td>-37.924400</td>
      <td>3.825484</td>
      <td>1100000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1465</th>
      <td>4</td>
      <td>11.2</td>
      <td>3186.0</td>
      <td>2</td>
      <td>4</td>
      <td>569.0</td>
      <td>10579.0</td>
      <td>8.487205</td>
      <td>145.052940</td>
      <td>-37.917660</td>
      <td>3.825472</td>
      <td>2800000</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Far from center
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Rooms</th>
      <th>Distance</th>
      <th>Postcode</th>
      <th>Bathroom</th>
      <th>Car</th>
      <th>Landsize</th>
      <th>Propertycount</th>
      <th>Distancia_NEW</th>
      <th>Longtitude</th>
      <th>Lattitude</th>
      <th>Location_TRA</th>
      <th>Price</th>
      <th>cat_precio</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3776</th>
      <td>4</td>
      <td>13.0</td>
      <td>3046.0</td>
      <td>2</td>
      <td>2</td>
      <td>535.2</td>
      <td>8870.0</td>
      <td>6.136212</td>
      <td>145.083569</td>
      <td>-37.819811</td>
      <td>3.836451</td>
      <td>640000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1170</th>
      <td>3</td>
      <td>13.9</td>
      <td>3165.0</td>
      <td>1</td>
      <td>4</td>
      <td>746.0</td>
      <td>10969.0</td>
      <td>9.403487</td>
      <td>145.078700</td>
      <td>-37.919800</td>
      <td>3.825935</td>
      <td>1300000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2383</th>
      <td>1</td>
      <td>8.1</td>
      <td>3161.0</td>
      <td>1</td>
      <td>1</td>
      <td>952.0</td>
      <td>6923.0</td>
      <td>3.539750</td>
      <td>145.037100</td>
      <td>-37.874400</td>
      <td>3.829423</td>
      <td>290000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3078</th>
      <td>3</td>
      <td>8.0</td>
      <td>3040.0</td>
      <td>1</td>
      <td>1</td>
      <td>503.0</td>
      <td>9264.0</td>
      <td>15.642122</td>
      <td>144.905900</td>
      <td>-37.745600</td>
      <td>3.839014</td>
      <td>1240000</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2233</th>
      <td>3</td>
      <td>3.2</td>
      <td>3054.0</td>
      <td>2</td>
      <td>1</td>
      <td>163.0</td>
      <td>3106.0</td>
      <td>8.187062</td>
      <td>144.975100</td>
      <td>-37.786000</td>
      <td>3.836741</td>
      <td>1955000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1414</th>
      <td>5</td>
      <td>11.2</td>
      <td>3186.0</td>
      <td>2</td>
      <td>2</td>
      <td>655.0</td>
      <td>10579.0</td>
      <td>9.681744</td>
      <td>145.004400</td>
      <td>-37.926400</td>
      <td>3.823310</td>
      <td>1562500</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4098</th>
      <td>2</td>
      <td>4.6</td>
      <td>3122.0</td>
      <td>1</td>
      <td>1</td>
      <td>0.0</td>
      <td>11308.0</td>
      <td>2.107194</td>
      <td>145.026000</td>
      <td>-37.824900</td>
      <td>3.834141</td>
      <td>445000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4480</th>
      <td>2</td>
      <td>4.2</td>
      <td>3031.0</td>
      <td>1</td>
      <td>1</td>
      <td>79.0</td>
      <td>5263.0</td>
      <td>10.505485</td>
      <td>144.934400</td>
      <td>-37.791400</td>
      <td>3.835116</td>
      <td>650000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>268</th>
      <td>4</td>
      <td>11.1</td>
      <td>3025.0</td>
      <td>1</td>
      <td>4</td>
      <td>558.0</td>
      <td>5132.0</td>
      <td>16.011262</td>
      <td>144.852900</td>
      <td>-37.845100</td>
      <td>3.827521</td>
      <td>650000</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4981</th>
      <td>3</td>
      <td>8.7</td>
      <td>3032.0</td>
      <td>1</td>
      <td>2</td>
      <td>597.0</td>
      <td>4918.0</td>
      <td>15.676748</td>
      <td>144.887700</td>
      <td>-37.763000</td>
      <td>3.836763</td>
      <td>975000</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_RF_xs</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;cluster&#39;</span><span class="p">)[</span><span class="s2">&quot;cat_precio&quot;</span><span class="p">,</span><span class="s2">&quot;Price&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="8" halign="left">cat_precio</th>
      <th colspan="8" halign="left">Price</th>
    </tr>
    <tr>
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>cluster</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>738.0</td>
      <td>0.619241</td>
      <td>0.485903</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>738.0</td>
      <td>1.157657e+06</td>
      <td>582701.527668</td>
      <td>341500.0</td>
      <td>767625.0</td>
      <td>988000.0</td>
      <td>1413000.0</td>
      <td>4650000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>887.0</td>
      <td>0.517475</td>
      <td>0.499976</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>887.0</td>
      <td>9.897082e+05</td>
      <td>413514.867489</td>
      <td>280000.0</td>
      <td>700000.0</td>
      <td>890000.0</td>
      <td>1219250.0</td>
      <td>2910000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>636.0</td>
      <td>0.451258</td>
      <td>0.498010</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>636.0</td>
      <td>9.200138e+05</td>
      <td>417934.530782</td>
      <td>330000.0</td>
      <td>605000.0</td>
      <td>820000.0</td>
      <td>1182750.0</td>
      <td>2640000.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>684.0</td>
      <td>0.823099</td>
      <td>0.381864</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>684.0</td>
      <td>1.661466e+06</td>
      <td>960344.836660</td>
      <td>440000.0</td>
      <td>983750.0</td>
      <td>1400000.0</td>
      <td>1963750.0</td>
      <td>6600000.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>769.0</td>
      <td>0.315995</td>
      <td>0.465213</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>769.0</td>
      <td>8.471784e+05</td>
      <td>420642.189752</td>
      <td>327500.0</td>
      <td>580000.0</td>
      <td>737000.0</td>
      <td>970000.0</td>
      <td>3171000.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>664.0</td>
      <td>0.231928</td>
      <td>0.422381</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>664.0</td>
      <td>6.568039e+05</td>
      <td>341081.099126</td>
      <td>160000.0</td>
      <td>412000.0</td>
      <td>550000.0</td>
      <td>832250.0</td>
      <td>2810000.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>622.0</td>
      <td>0.564309</td>
      <td>0.496246</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>622.0</td>
      <td>1.196831e+06</td>
      <td>750878.525099</td>
      <td>325000.0</td>
      <td>680000.0</td>
      <td>950000.0</td>
      <td>1478750.0</td>
      <td>7000000.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>En este caso los cluster 0, 2 y 6 son los que parecen tener los precios mas bajos aunque  el grupo 0 y el 6 ya contienen valores mas altos</p>
<p><strong>CONCLUSIÓN: en ambos casos es que en ningun de los dos casos agrupa de manera adecuada al precio (independientemente de si usamos o no TSNE para transformar los datos)</strong></p>
<p>Vamos a añadir una variable mas que tenia mucho peso que es el numero de habitaciones y probaremos de nuevo el cluster</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_RF</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">X_2</span><span class="o">.</span><span class="n">shape</span>




<span class="c1">#Inertia para Dataframe original</span>
<span class="n">K</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="n">inertia</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">K</span><span class="p">:</span>
    <span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_2</span><span class="p">)</span>
    <span class="n">inertia</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kmeans</span><span class="o">.</span><span class="n">inertia_</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">inertia</span><span class="p">,</span><span class="s1">&#39;.-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Cálculo de número de cluster óptimo para dataframe Original &#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;# of clusters&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Inertia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2-Aprendizaje-No-Super_33_0.png" src="_images/2-Aprendizaje-No-Super_33_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">labels_km</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X_2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cluster sizes k-means: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">labels_km</span><span class="p">)))</span>

<span class="n">distances</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">:</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">X_2</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> 
    <span class="n">distances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cluster distances k-means: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">labels_km</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="n">distances</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plot_silhouette</span><span class="p">(</span><span class="n">X_2</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span><span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cluster sizes k-means: [19513  7543]
Cluster distances k-means: [2099735.18, 4452240.82]
</pre></div>
</div>
<img alt="_images/2-Aprendizaje-No-Super_34_1.png" src="_images/2-Aprendizaje-No-Super_34_1.png" />
<img alt="_images/2-Aprendizaje-No-Super_34_2.png" src="_images/2-Aprendizaje-No-Super_34_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sb</span>

<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">Axes3D</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="n">colores</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;blue&#39;</span><span class="p">]</span>
<span class="n">asignarx</span><span class="o">=</span><span class="p">[]</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">labels_km</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">):</span>
    <span class="n">asignarx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">colores</span><span class="p">[</span><span class="n">row</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_2</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">X_2</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">X_2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">asignarx</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;mpl_toolkits.mplot3d.art3d.Path3DCollection at 0x7f8bec189390&gt;
</pre></div>
</div>
<img alt="_images/2-Aprendizaje-No-Super_35_1.png" src="_images/2-Aprendizaje-No-Super_35_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_RF</span><span class="p">[</span><span class="s1">&#39;cluster&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">labels_km</span>
<span class="n">sb</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">data_RF</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;cluster&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Rooms&quot;</span><span class="p">,</span><span class="s2">&quot;Lattitude&quot;</span><span class="p">,</span><span class="s2">&quot;Distancia_NEW&quot;</span><span class="p">,</span><span class="s2">&quot;Longtitude&quot;</span><span class="p">,</span><span class="s2">&quot;cat_precio&quot;</span><span class="p">],</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.PairGrid at 0x7f8bfc3f7b10&gt;
</pre></div>
</div>
<img alt="_images/2-Aprendizaje-No-Super_36_1.png" src="_images/2-Aprendizaje-No-Super_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;elementos mas cercanos y mas lejanos del cluster 0&quot;</span><span class="p">)</span>
<span class="n">close_to_far_from_center</span><span class="p">(</span><span class="n">X_2</span><span class="p">,</span><span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>elementos mas cercanos y mas lejanos del cluster 0
Close to center
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Rooms</th>
      <th>Distance</th>
      <th>Postcode</th>
      <th>Bathroom</th>
      <th>Car</th>
      <th>Landsize</th>
      <th>Propertycount</th>
      <th>Distancia_NEW</th>
      <th>Longtitude</th>
      <th>Lattitude</th>
      <th>Location_TRA</th>
      <th>Price</th>
      <th>cat_precio</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11604</th>
      <td>3</td>
      <td>7.5</td>
      <td>3040.0</td>
      <td>2</td>
      <td>1</td>
      <td>321.0</td>
      <td>9264.0</td>
      <td>8.051870</td>
      <td>145.018590</td>
      <td>-37.807902</td>
      <td>3.835605</td>
      <td>1520000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>21852</th>
      <td>3</td>
      <td>12.0</td>
      <td>3073.0</td>
      <td>1</td>
      <td>2</td>
      <td>523.0</td>
      <td>21650.0</td>
      <td>8.062897</td>
      <td>145.034955</td>
      <td>-37.800517</td>
      <td>3.836629</td>
      <td>740000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3225</th>
      <td>3</td>
      <td>5.8</td>
      <td>3078.0</td>
      <td>2</td>
      <td>4</td>
      <td>735.0</td>
      <td>2970.0</td>
      <td>8.060103</td>
      <td>145.022500</td>
      <td>-37.770600</td>
      <td>3.839560</td>
      <td>2350000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5673</th>
      <td>3</td>
      <td>5.5</td>
      <td>3070.0</td>
      <td>2</td>
      <td>2</td>
      <td>608.0</td>
      <td>11364.0</td>
      <td>8.082966</td>
      <td>144.996700</td>
      <td>-37.776300</td>
      <td>3.838298</td>
      <td>900000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5601</th>
      <td>3</td>
      <td>5.5</td>
      <td>3070.0</td>
      <td>2</td>
      <td>1</td>
      <td>267.0</td>
      <td>11364.0</td>
      <td>8.057352</td>
      <td>145.003300</td>
      <td>-37.774400</td>
      <td>3.838666</td>
      <td>1310000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>26117</th>
      <td>3</td>
      <td>12.3</td>
      <td>3166.0</td>
      <td>1</td>
      <td>2</td>
      <td>422.3</td>
      <td>3224.0</td>
      <td>8.085402</td>
      <td>145.073472</td>
      <td>-37.815133</td>
      <td>3.837126</td>
      <td>905000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3329</th>
      <td>3</td>
      <td>3.5</td>
      <td>3068.0</td>
      <td>1</td>
      <td>0</td>
      <td>370.0</td>
      <td>6244.0</td>
      <td>8.078150</td>
      <td>144.989200</td>
      <td>-37.779400</td>
      <td>3.837785</td>
      <td>1600000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>22480</th>
      <td>3</td>
      <td>5.3</td>
      <td>3070.0</td>
      <td>1</td>
      <td>2</td>
      <td>419.9</td>
      <td>11364.0</td>
      <td>8.052328</td>
      <td>145.012500</td>
      <td>-37.772200</td>
      <td>3.839133</td>
      <td>1290000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>24669</th>
      <td>3</td>
      <td>3.6</td>
      <td>3068.0</td>
      <td>2</td>
      <td>2</td>
      <td>139.0</td>
      <td>6244.0</td>
      <td>8.066954</td>
      <td>144.984340</td>
      <td>-37.781890</td>
      <td>3.837403</td>
      <td>1125000</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3233</th>
      <td>3</td>
      <td>5.8</td>
      <td>3078.0</td>
      <td>1</td>
      <td>1</td>
      <td>0.0</td>
      <td>2970.0</td>
      <td>8.047036</td>
      <td>145.017300</td>
      <td>-37.771400</td>
      <td>3.839341</td>
      <td>1500000</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Far from center
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Rooms</th>
      <th>Distance</th>
      <th>Postcode</th>
      <th>Bathroom</th>
      <th>Car</th>
      <th>Landsize</th>
      <th>Propertycount</th>
      <th>Distancia_NEW</th>
      <th>Longtitude</th>
      <th>Lattitude</th>
      <th>Location_TRA</th>
      <th>Price</th>
      <th>cat_precio</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20214</th>
      <td>3</td>
      <td>45.9</td>
      <td>3437.0</td>
      <td>2</td>
      <td>4</td>
      <td>40468.0</td>
      <td>290.0</td>
      <td>48.231807</td>
      <td>144.63257</td>
      <td>-37.54812</td>
      <td>3.851926</td>
      <td>930000</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>17077</th>
      <td>4</td>
      <td>47.3</td>
      <td>3810.0</td>
      <td>2</td>
      <td>2</td>
      <td>488.6</td>
      <td>17384.0</td>
      <td>48.306749</td>
      <td>145.51137</td>
      <td>-38.05934</td>
      <td>3.823276</td>
      <td>442000</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>23275</th>
      <td>3</td>
      <td>44.2</td>
      <td>3756.0</td>
      <td>1</td>
      <td>1</td>
      <td>555.5</td>
      <td>3988.0</td>
      <td>48.416964</td>
      <td>144.97782</td>
      <td>-37.40869</td>
      <td>3.875512</td>
      <td>390000</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>16710</th>
      <td>3</td>
      <td>44.2</td>
      <td>3756.0</td>
      <td>1</td>
      <td>1</td>
      <td>502.0</td>
      <td>3988.0</td>
      <td>48.437659</td>
      <td>144.97749</td>
      <td>-37.40853</td>
      <td>3.875520</td>
      <td>366000</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>11188</th>
      <td>3</td>
      <td>45.2</td>
      <td>3777.0</td>
      <td>2</td>
      <td>4</td>
      <td>724.0</td>
      <td>3307.0</td>
      <td>48.465570</td>
      <td>145.52635</td>
      <td>-37.64685</td>
      <td>3.865565</td>
      <td>650000</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>25562</th>
      <td>4</td>
      <td>44.2</td>
      <td>3756.0</td>
      <td>2</td>
      <td>2</td>
      <td>757.0</td>
      <td>3988.0</td>
      <td>48.509563</td>
      <td>144.98302</td>
      <td>-37.40744</td>
      <td>3.875780</td>
      <td>560000</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>20801</th>
      <td>3</td>
      <td>44.2</td>
      <td>3756.0</td>
      <td>1</td>
      <td>2</td>
      <td>679.0</td>
      <td>3988.0</td>
      <td>48.599281</td>
      <td>144.97590</td>
      <td>-37.40720</td>
      <td>3.875615</td>
      <td>411000</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>27016</th>
      <td>4</td>
      <td>44.2</td>
      <td>3756.0</td>
      <td>2</td>
      <td>6</td>
      <td>720.0</td>
      <td>3988.0</td>
      <td>49.150316</td>
      <td>144.96232</td>
      <td>-37.40349</td>
      <td>3.875636</td>
      <td>565000</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>23274</th>
      <td>5</td>
      <td>44.2</td>
      <td>3756.0</td>
      <td>3</td>
      <td>2</td>
      <td>908.8</td>
      <td>3988.0</td>
      <td>49.449786</td>
      <td>145.00176</td>
      <td>-37.39780</td>
      <td>3.877280</td>
      <td>600000</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>23276</th>
      <td>4</td>
      <td>44.2</td>
      <td>3756.0</td>
      <td>2</td>
      <td>2</td>
      <td>924.0</td>
      <td>3988.0</td>
      <td>49.578383</td>
      <td>144.96369</td>
      <td>-37.39946</td>
      <td>3.876090</td>
      <td>590000</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_RF</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;cluster&#39;</span><span class="p">)[</span><span class="s2">&quot;cat_precio&quot;</span><span class="p">,</span><span class="s2">&quot;Price&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="8" halign="left">cat_precio</th>
      <th colspan="8" halign="left">Price</th>
    </tr>
    <tr>
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>cluster</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>19513.0</td>
      <td>0.598524</td>
      <td>0.490209</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>19513.0</td>
      <td>1.164169e+06</td>
      <td>700796.849546</td>
      <td>85000.0</td>
      <td>691500.0</td>
      <td>1000000.0</td>
      <td>1430000.0</td>
      <td>11200000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7543.0</td>
      <td>0.248310</td>
      <td>0.432061</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>7543.0</td>
      <td>7.676423e+05</td>
      <td>316897.194666</td>
      <td>145000.0</td>
      <td>580000.0</td>
      <td>702000.0</td>
      <td>870750.0</td>
      <td>5000000.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="1-DefinicionObjetivos.html" title="previous page">1. Analisis Inicial</a>
    <a class='right-next' id="next-link" href="3-Reduccion_dimensionalidad.html" title="next page">3. Técnicas de reduccion de la dimensionalidad</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Ruven Valle, Jose Melero e Inmaculada Borrás<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>